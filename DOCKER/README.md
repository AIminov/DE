# Docker

## Что такое Docker?

**Docker** — это платформа, которая позволяет упаковывать приложения и их зависимости в изолированные контейнеры. Это облегчает развертывание и обеспечивает одинаковое поведение приложения в разных средах (локально, на сервере или в облаке).

### Преимущества Docker:
- **Портативность:** Работает одинаково на всех системах.
- **Изоляция:** Каждое приложение работает в своём контейнере.
- **Лёгкость:** Контейнеры занимают меньше ресурсов по сравнению с виртуальными машинами.
- **Удобство:** Упрощает управление зависимостями и процессами развертывания.

---

## Что такое Dockerfile?

**Dockerfile** — это текстовый файл с инструкциями для создания Docker-образа. 

Образ — это шаблон для создания контейнеров. Вы описываете в Dockerfile, какие программы и зависимости нужны вашему приложению, чтобы оно работало.

### Пример Dockerfile:
```Dockerfile
# Используем базовый образ Python
FROM python:3.10-slim

# Копируем файлы проекта в контейнер
COPY . /app

# Устанавливаем рабочую директорию
WORKDIR /app

# Устанавливаем зависимости
RUN pip install -r requirements.txt

# Запускаем приложение
CMD ["python", "app.py"]
```

Основные команды Dockerfile:
    
    •	FROM — задаёт базовый образ (например, python:3.10).
	•	COPY — копирует файлы с хост-машины в контейнер.
	•	WORKDIR — задаёт рабочую директорию.
	•	RUN — выполняет команды (например, установка пакетов).
	•	CMD — определяет команду, которая выполнится при запуске контейнера.

### Что такое docker-compose?

docker-compose — это инструмент для запуска нескольких связанных контейнеров.

Вместо запуска контейнеров вручную, вы описываете их конфигурацию в одном YAML-файле и управляете ими как единой системой.

```Dockerfile
version: "3.9"
services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "5000:5000"
    volumes:
      - .:/app
    environment:
      - FLASK_ENV=development
  db:
    image: postgres:13
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
      POSTGRES_DB: my_database
    ports:
      - "5432:5432"
```

Что здесь происходит?
1. services: Описывает контейнеры.
- app: Приложение (собирается из Dockerfile).
- db: СУБД PostgreSQL (использует готовый образ).
2. ports: Связывает порты хоста и контейнера.
3. volumes: Привязывает локальные файлы к контейнеру.
4. environment: Передаёт переменные окружения в контейнер.


**Для запуска:**
```Dockerfile
docker-compose up
```


## Распространённые команды Docker

Чтобы начать использовать Docker, полезно знать несколько базовых команд:

### Управление образами
- **`docker build -t <имя_образа> .`**  
  Собирает образ из Dockerfile в текущей директории.
- **`docker images`**  
  Показывает список всех образов на вашем компьютере.
- **`docker rmi <image_id>`**  
  Удаляет образ по его идентификатору.

### Управление контейнерами
- **`docker run -d -p 5000:5000 <имя_образа>`**  
  Запускает контейнер в фоновом режиме и связывает порты.
- **`docker ps`**  
  Показывает запущенные контейнеры.
- **`docker ps -a`**  
  Показывает все контейнеры, включая остановленные.
- **`docker stop <container_id>`**  
  Останавливает запущенный контейнер.
- **`docker rm <container_id>`**  
  Удаляет остановленный контейнер.

### Просмотр логов
- **`docker logs <container_id>`**  
  Показывает логи контейнера.
- **`docker logs -f <container_id>`**  
  Отображает логи в реальном времени.